<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Page - Admin Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin-styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.ckeditor.com/ckeditor5/39.0.1/classic/ckeditor.js"></script>
    <style>
        :root{
  --primary-color:#0ea5e9;
  --secondary-color:#2563eb;
  --success-color:#10b981;
  --warning-color:#f59e0b;
  --danger-color:#ef4444;
  --dark-color:#1f2937;
  --light-color:#f8fafc;

  /* extras */
  --radius:14px;
  --radius-sm:10px;
  --shadow-sm:0 4px 6px rgba(0,0,0,.10);
  --shadow-md:0 8px 25px rgba(0,0,0,.14);
  --fs-base:clamp(14px,1.6vw,16px);
  --fs-h2:clamp(1.1rem,2.4vw,1.5rem);
  --fs-h3:clamp(1rem,2vw,1.25rem);
}

html{-webkit-text-size-adjust:100%}
*,*::before,*::after{box-sizing:border-box}

body{
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height:100vh;
  font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size:var(--fs-base);
  line-height:1.55;
  margin:0;
}

/* ===== Header ===== */
.admin-header{
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  color:#fff;
  padding: clamp(.75rem, 2vw, 1rem) 0;
  box-shadow: var(--shadow-sm);
}
.admin-header h2{
  margin:0 0 .25rem 0;
  font-size:var(--fs-h2);
}
.admin-header p{
  margin:0;
  font-size:clamp(.9rem,1.6vw,1rem);
  opacity:.95;
}

/* ===== Top Nav (pills) ===== */
.admin-nav{
  background:#fff;
  border-radius: var(--radius);
  box-shadow: var(--shadow-sm);
  margin: clamp(1rem,3vw,2rem) 0;
  padding: clamp(.75rem,2vw,1rem);
}
.nav-pills{gap:.25rem; flex-wrap:wrap}
.nav-link{
  color:var(--dark-color);
  font-weight:600;
  padding:.6rem .95rem;
  border-radius:10px;
  transition: transform .2s ease, background .2s ease, color .2s ease;
  white-space:nowrap;
}
.nav-link:hover,.nav-link.active{
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  color:#fff !important;
  transform: translateY(-2px);
}

/* ===== Cards: stats + content ===== */
.stats-card,
.content-section{
  background:#fff;
  border-radius: var(--radius);
  padding: clamp(1rem,3vw,2rem);
  box-shadow: var(--shadow-md);
  border:none;
  margin-bottom: clamp(1rem,3vw,2rem);
}
.stats-card{transition: transform .2s ease}
.stats-card:hover{transform: translateY(-4px)}
.stats-icon{
  width:60px;height:60px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:1.5rem;color:#fff;margin-bottom:.8rem;
}
.stats-number{
  font-size:clamp(1.6rem,4vw,2.5rem);
  font-weight:800;color:var(--dark-color);margin-bottom:.35rem;
}
.stats-label{color:#6b7280;font-weight:600}

.section-title{
  color:var(--dark-color);
  font-weight:800;
  margin-bottom:1rem;
  padding-bottom:.5rem;
  border-bottom:3px solid var(--primary-color);
  font-size:var(--fs-h3);
}

/* ===== Buttons ===== */
.btn-primary{
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  border:none;border-radius:10px;
  padding:.7rem 1.25rem;font-weight:700;
  transition: transform .2s ease, box-shadow .2s ease, opacity .2s ease;
}
.btn-primary:hover{
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(14,165,233,.35);
}

/* Outline light buttons in header stay readable on small screens */
.btn-outline-light{border-color:rgba(255,255,255,.7)}

/* On very small screens, stack header actions */
@media (max-width: 575.98px){
  .admin-header .d-flex{flex-direction:column; align-items:flex-start; gap:.5rem}
  .admin-header .btn{width:100%}
}

/* ===== Quick actions grid ===== */
.quick-actions{
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: clamp(.75rem,2vw,1rem);
  margin-top: clamp(1rem,2.5vw,2rem);
}
.action-card{
  background:#fff;border-radius:12px;padding:1.25rem;text-align:center;
  box-shadow: var(--shadow-sm);transition: transform .2s ease, box-shadow .2s ease, color .2s ease;
  text-decoration:none;color:var(--dark-color);
}
.action-card:hover{
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0,0,0,.15);
  color: var(--primary-color);
}
.action-icon{font-size:2rem;margin-bottom:.6rem;color:var(--primary-color)}

/* ===== Tables ===== */
.table{
  border-radius:10px; overflow:hidden; background:#fff;
  box-shadow: var(--shadow-sm);
}
.table thead th{
  background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
  color:#fff;border:none;font-weight:700;
  padding: clamp(.7rem,2vw,1rem);
  white-space:nowrap;
}
.table tbody td{
  padding: clamp(.6rem,2vw,1rem);
  vertical-align:middle;border-color:#e5e7eb;
  word-break:break-word;
}
.table tbody td strong{font-weight:700}
.badge{padding:.45rem .7rem;border-radius:20px;font-weight:700;font-size:.8rem}

/* Make tables easier on phones */
.table-responsive{overflow-x:auto}
@media (max-width: 575.98px){
  .table tbody td:first-child strong{display:inline-block; max-width:100%}
}

/* ===== Bootstrap grid tweaks ===== */
@media (max-width: 991.98px){
  .row>[class*="col-"]{margin-bottom:1rem}
}

/* ===== Reduced motion ===== */
@media (prefers-reduced-motion: reduce){
  *{transition:none !important; animation:none !important}
}

    </style>
</head>
<body>
    <div class="admin-container">
        <aside class="admin-sidebar">
            <div class="admin-logo">
                <h2>STARBLUE Admin</h2>
            </div>
            <nav class="admin-nav">
                <ul>
                    <li><a href="{{ url_for('admin_dashboard') }}"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="{{ url_for('admin_bookings') }}"><i class="fas fa-ticket-alt"></i> Bookings</a></li>
                    <li><a href="{{ url_for('admin_users') }}"><i class="fas fa-users"></i> Users</a></li>
                    <li class="nav-section">
                        <span>Transport</span>
                        <ul>
                            <li><a href="{{ url_for('admin_flights') }}"><i class="fas fa-plane"></i> Flights</a></li>
                            <li><a href="{{ url_for('admin_trains') }}"><i class="fas fa-train"></i> Trains</a></li>
                            <li><a href="{{ url_for('admin_buses') }}"><i class="fas fa-bus"></i> Buses</a></li>
                        </ul>
                    </li>
                    <li class="nav-section">
                        <span>Content</span>
                        <ul>
                            <li><a href="{{ url_for('admin_blog') }}"><i class="fas fa-blog"></i> Blog Posts</a></li>
                            <li><a href="{{ url_for('admin_faq') }}"><i class="fas fa-question-circle"></i> FAQ</a></li>
                            <li><a href="{{ url_for('admin_pages') }}" class="active"><i class="fas fa-file-alt"></i> Pages</a></li>
                        </ul>
                    </li>
                    <li><a href="{{ url_for('admin_reports') }}"><i class="fas fa-chart-bar"></i> Reports</a></li>
                    <li><a href="{{ url_for('admin_settings') }}"><i class="fas fa-cog"></i> Settings</a></li>
                </ul>
            </nav>
        </aside>

        <main class="admin-main">
            <header class="admin-header">
                <h1>Add New Page</h1>
                <div class="admin-actions">
                    <a href="{{ url_for('admin_pages') }}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Pages
                    </a>
                    <a href="{{ url_for('logout') }}" class="btn btn-danger">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a>
                </div>
            </header>

            <div class="admin-content">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-{{ category }}">{{ message }}</div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                <form method="POST" action="{{ url_for('admin_add_page') }}" class="page-form" id="pageForm">
                    <div class="form-row">
                        <div class="form-group col-md-8">
                            <div class="content-card">
                                <div class="card-header">
                                    <h2>Page Content</h2>
                                </div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label for="title" class="required">Page Title</label>
                                        <input type="text" id="title" name="title" class="form-control" required>
                                    </div>

                                    <div class="form-group">
                                        <label for="content" class="required">Content</label>
                                        <textarea id="content" name="content" class="form-control" rows="15" required></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group col-md-4">
                            <div class="content-card">
                                <div class="card-header">
                                    <h2>Page Settings</h2>
                                </div>
                                <div class="card-body">
                                    <div class="form-group">
                                        <label for="status">Status</label>
                                        <select id="status" name="status" class="form-control">
                                            <option value="draft">Draft</option>
                                            <option value="published" selected>Published</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="template">Template</label>
                                        <select id="template" name="template" class="form-control">
                                            <option value="dynamic_page.html">Default Page</option>
                                        </select>
                                        <small class="form-text">Template used to display this page</small>
                                    </div>

                                    <div class="form-group">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="show_in_menu" name="show_in_menu">
                                            <label class="form-check-label" for="show_in_menu">
                                                Show in navigation menu
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="menu_order">Menu Order</label>
                                        <input type="number" id="menu_order" name="menu_order" class="form-control" value="0" min="0">
                                        <small class="form-text">Lower numbers appear first in menu</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="meta_description">Meta Description</label>
                                        <textarea id="meta_description" name="meta_description" class="form-control" rows="3" placeholder="Brief description for search engines"></textarea>
                                        <small class="form-text">Recommended: 150-160 characters</small>
                                    </div>

                                    <div class="form-group">
                                        <label for="meta_keywords">Meta Keywords</label>
                                        <input type="text" id="meta_keywords" name="meta_keywords" class="form-control" placeholder="keyword1, keyword2, keyword3">
                                        <small class="form-text">Separate keywords with commas</small>
                                    </div>

                                    <div class="form-actions">
                                        <button type="submit" class="btn btn-primary btn-block" id="createPageBtn">
                                            <i class="fas fa-save"></i> Create Page
                                        </button>
                                        <a href="{{ url_for('admin_pages') }}" class="btn btn-secondary btn-block">
                                            <i class="fas fa-times"></i> Cancel
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </main>
    </div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    ClassicEditor
        .create(document.querySelector('#content'))
        .catch(error => {
            console.error('CKEditor initialization error:', error);
        });
});
</script>

    <script>
        // Initialize CKEditor
        ClassicEditor
            .create(document.querySelector('#content'), {
                toolbar: {
                    items: [
                        'heading', '|',
                        'bold', 'italic', 'link', '|',
                        'bulletedList', 'numberedList', '|',
                        'outdent', 'indent', '|',
                        'blockQuote', 'insertTable', '|',
                        'undo', 'redo'
                    ],
                    shouldNotGroupWhenFull: true
                },
                placeholder: 'Write your page content here...'
            })
            .catch(error => {
                console.error(error);
            });

        // Form submission handler
        document.addEventListener('DOMContentLoaded', function() {
            const pageForm = document.getElementById('pageForm');
            const createPageBtn = document.getElementById('createPageBtn');
            
            pageForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Show loading state on button
                createPageBtn.disabled = true;
                createPageBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating Page...';
                
                // Get form data
                const formData = new FormData(pageForm);
                
                // Send AJAX request
                fetch(pageForm.action, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'Accept': 'application/json'
                    }
                })
                .then(response => {
                    if (response.redirected) {
                        window.location.href = response.url;
                    } else {
                        return response.json();
                    }
                })
                .then(data => {
                    if (data && data.error) {
                        alert(data.error);
                        createPageBtn.disabled = false;
                        createPageBtn.innerHTML = '<i class="fas fa-save"></i> Create Page';
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    createPageBtn.disabled = false;
                    createPageBtn.innerHTML = '<i class="fas fa-save"></i> Create Page';
                });
            });
            
            // Basic client-side validation
            pageForm.addEventListener('input', function() {
                const title = document.getElementById('title').value.trim();
                const content = document.getElementById('content').value.trim();
                createPageBtn.disabled = !(title && content);
            });
        });
    </script>
</body>
</html>