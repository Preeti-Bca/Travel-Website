{% extends "base.html" %}

{% block title %}FAQ - STARBLUE{% endblock %}

{% block extra_css %}
<style>
  /* ===== Base / Theme ===== */
  :root{
    --brand:#2563eb;
    --ink:#1e293b;
    --muted:#64748b;
    --bg:#f6f8fa;
    --card:#ffffff;
    --ring: 0 0 0 3px rgba(37,99,235,.2);
  }
  @media (prefers-color-scheme:dark){
    :root{
      --bg:#0b1220;
      --card:#0f172a;
      --ink:#e5e7eb;
      --muted:#94a3b8;
    }
  }

  body{
    background:var(--bg);
    color:var(--ink);
    font-family:'Segoe UI', Arial, sans-serif;
    -webkit-tap-highlight-color: transparent;
  }

  /* ===== Hero ===== */
  .faq-hero{
    background: linear-gradient(120deg, var(--brand) 0%, #0f172a 100%);
    color:#fff;
    padding:clamp(36px,5vw,70px) 0 clamp(24px,3vw,50px);
    margin-bottom:clamp(20px,3vw,40px);
    border-radius:0 0 24px 24px;
    box-shadow:0 4px 24px rgba(30,41,59,.08);
    text-align:center;
  }
  .faq-hero h1{
    font-size:clamp(1.5rem,2.2vw + 1rem,2.7rem);
    font-weight:800;
    letter-spacing:.2px;
    margin-bottom:12px;
    text-shadow:0 2px 8px rgba(0,0,0,.10);
  }
  .faq-hero p{
    font-size:clamp(.95rem, .3vw + .8rem,1.15rem);
    opacity:.95;
    max-width:48rem;
    margin:0 auto;
  }

  /* ===== Search ===== */
  .search-faq{
    max-width:520px;
    margin:0 auto 28px;
    position:relative;
  }
  .search-faq input{
    width:100%;
    padding:13px 44px 13px 16px;
    border:1.5px solid var(--brand);
    border-radius:999px;
    font-size:1rem;
    background:var(--card);
    color:var(--ink);
    outline:none;
    transition:border-color .2s, box-shadow .2s;
  }
  .search-faq input:focus{ box-shadow:var(--ring); border-color:#0f172a; }
  .search-faq i{
    position:absolute; right:16px; top:50%; transform:translateY(-50%);
    color:var(--brand); font-size:1.05rem;
  }

  /* ===== Category filter ===== */
  .category-filter{
    display:flex; flex-wrap:wrap; gap:10px;
    justify-content:center; margin-bottom:22px;
  }
  .category-btn{
    padding:10px 18px;
    border:1.5px solid var(--brand);
    background:var(--card); color:var(--brand);
    border-radius:999px; font-weight:600; font-size:.98rem;
    transition:transform .18s, box-shadow .18s, background .18s, color .18s, border-color .18s;
    line-height:1; min-height:44px; /* touch target */
    box-shadow:0 2px 8px rgba(37,99,235,.04);
    display:inline-flex; align-items:center; gap:.5rem;
  }
  .category-btn:hover,
  .category-btn.active{
    background:var(--brand); color:#fff; border-color:#0f172a;
    transform:translateY(-2px);
    box-shadow:0 8px 18px rgba(37,99,235,.18);
    text-decoration:none;
  }

  /* ===== Section / Titles ===== */
  .faq-section{ margin-bottom:28px; }
  .faq-category-title{
    color:var(--ink); font-size:clamp(1.05rem, .4vw + 1rem,1.25rem);
    font-weight:700; margin:10px 0 14px; padding-bottom:6px;
    border-bottom:2px solid var(--brand); display:inline-flex; align-items:center; gap:.5rem;
    letter-spacing:.3px;
  }

  /* ===== Items / Accordion ===== */
  .faq-item{
    background:var(--card);
    border-radius:12px;
    border:1px solid rgba(148,163,184,.25);
    box-shadow:0 2px 12px rgba(30,41,59,.06);
    margin-bottom:14px; overflow:hidden;
    transition:box-shadow .2s, transform .2s, border-color .2s;
  }
  .faq-item:hover{ box-shadow:0 8px 22px rgba(37,99,235,.12); transform:translateY(-2px); }

  .faq-question{
    background:#f1f5f9;
    padding:clamp(12px,1.6vw,18px) clamp(14px,2.4vw,24px);
    margin:0; cursor:pointer; border:none; width:100%; text-align:left;
    font-size:clamp(.95rem, .3vw + .85rem,1.06rem);
    font-weight:700; color:#0f172a;
    display:flex; justify-content:space-between; align-items:center; gap:12px;
    transition:background .18s, color .18s;
  }
  @media (prefers-color-scheme:dark){
    .faq-question{ background:#0b1526; color:var(--ink); }
  }
  .faq-question:hover,
  .faq-question[aria-expanded="true"]{
    background:var(--brand); color:#fff;
  }
  .faq-question i{ font-size:1.1rem; transition:transform .25s ease; }
  .faq-question[aria-expanded="true"] i{ transform:rotate(180deg); }

  /* Outer collapse wrapper in your markup also has .faq-answer – handle both safely */
  .collapse.faq-answer{ background:var(--card); }
  /* Inner actual answer block (don’t double-pad if nested) */
  .faq-answer .faq-answer{ padding:0; border:none; }

  .faq-answer{
    padding:clamp(14px,2vw,22px) clamp(14px,2.2vw,28px);
    background:var(--card); color:#374151;
    line-height:1.7; font-size:1rem; border-top:1px solid rgba(148,163,184,.25);
  }
  .faq-answer p{ margin-bottom:.75rem; }
  .faq-answer p:last-child{ margin-bottom:0; }

  /* ===== Empty state ===== */
  .no-results{
    text-align:center; padding:48px 16px; color:var(--muted);
  }
  .no-results i{ font-size:3rem; color:var(--brand); margin-bottom:12px; }

  /* ===== Contact support CTA ===== */
  .contact-support{
    background: linear-gradient(120deg, var(--brand) 0%, #0f172a 100%);
    color:#fff; padding:clamp(18px,3vw,32px);
    border-radius:14px; text-align:center; margin-top:34px;
    box-shadow:0 2px 16px rgba(30,41,59,.12);
  }
  .contact-support h3{ margin-bottom:8px; font-weight:800; font-size:clamp(1rem, .4vw + .9rem,1.2rem); }
  .contact-support p{ margin-bottom:16px; opacity:.95; }
  .contact-support .btn{
    background:#fff; color:var(--brand); border:none;
    padding:11px 26px; border-radius:999px; font-weight:800;
    display:inline-flex; align-items:center; gap:.5rem; min-height:44px;
    transition:transform .18s, box-shadow .18s, background .18s, color .18s;
    box-shadow:0 2px 8px rgba(37,99,235,.10); text-decoration:none;
  }
  .contact-support .btn:hover{ background:var(--brand); color:#fff; transform:translateY(-1px); box-shadow:0 8px 20px rgba(37,99,235,.18); }

  /* ===== Accessibility: focus states ===== */
  .category-btn:focus,
  .faq-question:focus,
  .contact-support .btn:focus,
  .search-faq input:focus{ outline:none; box-shadow:var(--ring); }

  /* ===== Responsive tweaks ===== */
  @media (max-width: 992px){
    .faq-hero{ border-radius:0 0 18px 18px; }
    .faq-category-title{ display:block; }
  }
  @media (max-width: 576px){
    .category-filter{ gap:8px; }
    .category-btn{ padding:10px 14px; font-size:.95rem; }
    .faq-question{ padding:12px 14px; }
    .faq-answer{ padding:14px 14px; }
    .search-faq{ max-width:100%; }
  }

  /* ===== Motion preferences ===== */
  @media (prefers-reduced-motion:reduce){
    *{ transition:none!important; animation:none!important; }
  }
</style>

{% endblock %}

{% block content %}
<!-- FAQ Hero Section -->
<section class="faq-hero">
    <div class="container text-center">
        <h1><i class="fas fa-question-circle me-3"></i>Frequently Asked Questions</h1>
        <p>Find answers to common questions about booking, travel, and our services</p>
    </div>
</section>

<div class="container">
    <!-- Search FAQ -->
    <div class="search-faq">
        <input type="text" id="faqSearch" placeholder="Search FAQs..." onkeyup="searchFAQ()">
        <i class="fas fa-search"></i>
    </div>
    
    <!-- Category Filter -->
    <div class="category-filter">
        <a href="{{ url_for('faq') }}" class="category-btn {{ 'active' if not current_category else '' }}">
            <i class="fas fa-th-large me-2"></i>All Categories
        </a>
        {% for category in categories %}
        <a href="{{ url_for('faq', category=category) }}" 
           class="category-btn {{ 'active' if current_category == category else '' }}">
            <i class="fas fa-tag me-2"></i>{{ category }}
        </a>
        {% endfor %}
    </div>
    
    <!-- FAQ Content -->
    {% if faqs %}
        {% set current_cat = '' %}
        {% for faq in faqs %}
            {% if faq.category != current_cat %}
                {% if current_cat != '' %}
                    </div>
                {% endif %}
                {% set current_cat = faq.category %}
                <div class="faq-section">
                    <h2 class="faq-category-title">
                        <i class="fas fa-folder-open me-2"></i>{{ faq.category }}
                    </h2>
            {% endif %}
            
            <div class="faq-item" data-category="{{ faq.category|lower }}" data-question="{{ faq.question|lower }}">
                <button class="faq-question" type="button" data-bs-toggle="collapse" 
                        data-bs-target="#faq{{ faq.id }}" aria-expanded="false">
                    {{ faq.question }}
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="collapse faq-answer" id="faq{{ faq.id }}">
                    <div class="faq-answer">
                        {{ faq.answer|safe }}
                    </div>
                </div>
            </div>
            
            {% if loop.last %}
                </div>
            {% endif %}
        {% endfor %}
    {% else %}
        <div class="no-results">
            <i class="fas fa-search"></i>
            <h3>No FAQs Found</h3>
            <p>We couldn't find any FAQs matching your criteria.</p>
        </div>
    {% endif %}
    
    <!-- Contact Support -->
    <div class="contact-support">
        <h3><i class="fas fa-headset me-2"></i>Still Need Help?</h3>
        <p>Can't find the answer you're looking for? Our support team is here to help!</p>
        <a href="{{ url_for('contact') }}" class="btn">
            <i class="fas fa-envelope me-2"></i>Contact Support
        </a>
    </div>
</div>

<script>
function searchFAQ() {
    const searchTerm = document.getElementById('faqSearch').value.toLowerCase();
    const faqItems = document.querySelectorAll('.faq-item');
    let hasResults = false;
    
    faqItems.forEach(item => {
        const question = item.getAttribute('data-question');
        const category = item.getAttribute('data-category');
        
        if (question.includes(searchTerm) || category.includes(searchTerm)) {
            item.style.display = 'block';
            hasResults = true;
        } else {
            item.style.display = 'none';
        }
    });
    
    // Show/hide category titles based on visible items
    const sections = document.querySelectorAll('.faq-section');
    sections.forEach(section => {
        const visibleItems = section.querySelectorAll('.faq-item[style="display: block"], .faq-item:not([style*="display: none"])');
        section.style.display = visibleItems.length > 0 ? 'block' : 'none';
    });
}
</script>
{% endblock %}
